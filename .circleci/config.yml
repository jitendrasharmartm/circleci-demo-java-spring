version: 2
jobs:
  build:
    
    working_directory: ~/circleci-demo-java-spring

    docker:
      - image: circleci/openjdk:8-jdk-stretch
      - image: circleci/postgres:9.6.3-alpine
        environment:
          POSTGRES_USER: root
          POSTGRES_DB: circle_test

    steps:

      - checkout
      - add_ssh_keys:
          fingerprints:
            - '95:39:67:8e:fd:fe:28:7e:41:36:a6:15:79:1e:53:da'
      - run:
          name: Keyscan mydomain.com (HACK)
          command: ssh-keyscan -H 3.128.197.11 >> ~/.ssh/known_hosts
      - run:
        name: ansible command
        command: ansible all -m ping
